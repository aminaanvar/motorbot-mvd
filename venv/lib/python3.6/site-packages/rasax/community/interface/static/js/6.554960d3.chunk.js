(this["webpackJsonprasa-frontend"]=this["webpackJsonprasa-frontend"]||[]).push([[6],{1897:function(e,r,t){"use strict";t.r(r);var n=t(2),l=t(0),o=t(1),a=t(18),s=t(5),c=t(162),u=t(111),i=t(45),d=t(68),f=t(4),j=t(24),b=t(97),h=t(61),x=t(3),v=t(9),O=t(31),w=t(390),m=t(201);function y(e){return null!==e}function p(e){var r=e.onDelete,t=e.onLoadMoreRows,n=e.onSaveUserRoles,a=e.onSearch,s=e.roles,c=e.searchQuery,u=e.total,i=e.unfilteredTotal,d=e.users,j=o.useCallback((function(e,r){return Object(l.jsx)(w.a,{p:4,name:"Roles",items:s.map((function(e){return e.role})),checkedItems:e.filter((function(e){return"role"===e.keyword})).map((function(e){return e.value})),onChange:function(t){return r(e.filter((function(e){return"role"!==e.keyword})).concat(t.map((function(e){return{keyword:"role",value:e,negated:!1}}))))}})}),[s]),b=o.useMemo((function(){return{keyword:"role",values:s.map((function(e){return{label:e.role,total:e.users_count||0}})),clear:!0,all:"All",total:i}}),[s,i]),p=o.useCallback((function(e){var r=e.selected,t=e.onChangeSelected;return function(e){var n=e.rowIndex,o=e.rowData;if(!o)return null;var a=r.includes(n);return Object(l.jsxs)(f.Flex,{alignItems:"center",children:[Object(l.jsx)(f.Box,{flex:"0 1 auto",mr:3,children:Object(l.jsx)("label",{children:Object(l.jsx)(x.f,{checked:a,onChange:function(){return t(n,!a)}})})}),Object(l.jsx)(f.Box,{flex:"1",style:{overflow:"hidden",textOverflow:"ellipsis"},children:Object(l.jsx)(x.y,{variant:"bodySecondary",children:o.username})})]})}}),[]),R=function(e){var r=e.rowData,t=e.rowIndex,o=r;if(!o)return null;var a=s.map((function(e){return{label:e.role,value:e.role,data:e}})),c=s.reduce((function(e,r){return e[r.role]=r,e}),{}),u=o.roles.map((function(e){var r=c[e];return r?{label:r.role,value:r.role,data:r}:null})).filter(y);return Object(l.jsx)(x.p,{placeholder:"Search roles...",fullWidth:!0,items:a,onChange:function(e){Array.isArray(e)&&n({userIndex:t,user:o,roles:e.map((function(e){return e.data}))})},value:u})},k=function(e){var t=e.rowData;return t?Object(l.jsx)(f.Flex,{flexDirection:"row-reverse",mr:-1,children:Object(l.jsx)(O.a,{resource:v.d.Users,action:v.a.Delete,yes:Object(l.jsx)(x.d,{mr:1,variant:"icon",onClick:function(){r([t])},children:Object(l.jsx)(x.j,{icon:"trash-alt"})})})}):null};return Object(l.jsx)(m.a,{bulkActionsRenderer:function(e){var t=e.dataSelected,n=e.setSelected;return Object(l.jsx)(O.a,{resource:v.d.Users,action:v.a.Delete,yes:Object(l.jsx)(x.d,{onClick:function(){r(t),n([])},variant:"inverse",children:"Delete"})})},data:d,filtersRenderer:j,quickFilters:b,onLoadMoreRows:t,onSearch:a,resource:v.d.User,searchQuery:c,total:u,children:function(e){return[Object(l.jsx)(h.d,{cellDataGetter:function(){},flexGrow:2,width:300,dataKey:"username",label:"User",className:"ReactVirtualized__Table__rowColumn_overflow",cellRenderer:p(e)},"model"),Object(l.jsx)(h.d,{cellDataGetter:function(){},flexGrow:3,width:450,dataKey:"roles",label:"Roles",cellRenderer:R},"type"),Object(l.jsx)(h.d,{cellDataGetter:function(){},flexGrow:1,width:150,dataKey:"username",className:"ReactVirtualized__Table__rowColumnOnHover",label:"",cellRenderer:k},"actions")]}})}function R(e){var r=e.onDelete,t=e.onFetchRoles,n=e.onFetchUsers,a=e.onLoadMoreRows,s=e.onSaveUserRoles,c=e.roles,u=e.searchQuery,i=e.total,d=e.users,h=e.unfilteredTotal,x=Object(j.l)();o.useEffect((function(){x("view:users:loaded")}),[x]),o.useEffect((function(){t({search:"",offset:0,limit:0}),n({search:u,offset:0,limit:20})}),[t,n,u]);var v=o.useCallback((function(e){return n({search:e,offset:0,limit:20})}),[n]),O=Object.values(c);return Object(l.jsx)(b.a,{title:"Users",children:Object(l.jsx)(f.Flex,{flexDirection:"column",style:{height:"100%"},children:Object(l.jsx)(f.Box,{flex:"1",children:Object(l.jsx)(p,{roles:O,total:i,users:d,unfilteredTotal:h,onDelete:r,onLoadMoreRows:a,onSearch:v,searchQuery:u,onSaveUserRoles:s})})})})}var k={onFetchUsers:i.c.request,onDelete:i.a.request,onFetchRoles:d.d.request,onSaveUserRoles:i.e.request};r.default=Object(a.b)((function(e){return{users:e.users.users,total:e.users.total,searchQuery:e.users.searchQuery,roles:e.roles.roles,unfilteredTotal:e.users.unfilteredTotal}}),k)((function(e){return Object(l.jsx)(c.a,{listener:u.b,start:Object(s.getType)(i.c.request),resolve:Object(s.getType)(i.c.success),reject:Object(s.getType)(i.c.failure),children:function(r){return Object(l.jsx)(R,Object(n.a)(Object(n.a)({},e),{},{onLoadMoreRows:r}))}})}))}}]);